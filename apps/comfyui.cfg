[app_info]
APP_NAME=comfyui
APP_VERSION=v0.3.40
REPO_URL=https://github.com/comfyanonymous/ComfyUI

PROP_DISABLE_WINDOWS=YES

ENV_VAR=INSTALL_DIR_PREFIX_APP=${ROCM_HOME}/apps/comfyui

CMD_EXEC_DIR=${RCB_APP_SRC_DIR}

CMD_PRE_CONFIG = python3 -m pip install -r ./requirements.txt
CMD_INSTALL = mkdir -p ${INSTALL_DIR_PREFIX_APP}
              cd ${RCB_APP_SRC_DIR}
              git archive HEAD | tar -x -C ${INSTALL_DIR_PREFIX_APP}
              echo "cd ${ROCM_HOME}/apps/comfyui" > ${ROCM_HOME}/bin/comfyui.sh
              echo "export LD_LIBRARY_PATH=${ROCM_HOME}/lib:${ROCM_HOME}/lib/llvm/lib:${LD_LIBRARY_PATH}" >> ${ROCM_HOME}/bin/comfyui.sh
              echo "python3 main.py" >> ${ROCM_HOME}/bin/comfyui.sh
              chmod u+x ${ROCM_HOME}/bin/comfyui.sh
